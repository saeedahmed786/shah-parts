(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2222],{72590:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return t(14496)}])},86571:function(e,s,t){"use strict";var l=t(85893);t(67294);var r=t(94704),a=t(89552),n=t(63780),i=t(42459),c=t(97362);let{Step:d}=r.default;s.Z=e=>{let{loading:s,step:t}=e;return(0,l.jsx)(a.default,{spinning:s,children:(0,l.jsxs)(r.default,{current:t,children:[(0,l.jsx)(d,{title:"Cart",icon:(0,l.jsx)(i.Z,{}),description:"Items added to cart"}),(0,l.jsx)(d,{title:"Checkout and Payment",icon:(0,l.jsx)(n.Z,{}),description:"Address is filled and Payment is done"}),(0,l.jsx)(d,{title:"Order Complete",icon:(0,l.jsx)(c.Z,{}),description:"Order is completed"})]})})}},14496:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return checkout}});var l=t(85893),r=t(67294),a=t(10368),n=t.n(a),i=t(4863),c=t(5789),d=t(74253),o=t(97538),u=t(51024),h=t(55673),m=t(86978),p=t(38293),x=t(11163),j=t(30381),f=t.n(j),g=t(5121),v=t(80912),_=t(45770),N=t(72635),b=t.n(N),y=t(86571),k=t(75021);let S={layout:"vertical"},PaypalButtonWrapper=e=>{let{currency:s,showSpinner:t,placeOrder:a,amount:n}=e,[{options:i,isPending:c},d]=(0,k.Up)();return(0,r.useEffect)(()=>{d({type:"resetOptions",value:{...i,currency:s}})},[s,t]),(0,l.jsxs)(l.Fragment,{children:[t&&c&&(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)(k.ch,{style:S,disabled:!1,forceReRender:[n,s,S],fundingSource:void 0,createOrder:(e,t)=>t.order.create({purchase_units:[{amount:{currency_code:s,value:n}}]}).then(e=>e),onApprove:function(e,s){return console.log(e),s.order.capture().then(function(e){a(e)})}})]})};var checkout=()=>{let{TextArea:e}=u.default,[s]=o.Z.useForm(),t=(0,x.useRouter)(),[a,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)({}),[A,I]=(0,r.useState)(!1),[P,Z]=(0,r.useState)(""),[D,E]=(0,r.useState)(!1),[T,w]=(0,r.useState)({}),[C,O]=(0,r.useState)({}),{cart:M,clearCart:Y}=(0,_.i)();(0,r.useMemo)(()=>b()().getData(),[]);let F=null==M?void 0:M.reduce((e,s)=>e+parseInt(null==s?void 0:s.Price)*parseInt(null==s?void 0:s.qtyToShop),0),transactionSuccess=async e=>{await g.Z.post("".concat("http://localhost:8000/api","/orders/place-order"),{notes:P,placed:f()().format("DD/MM/YYYY"),subTotal:F,shipping:210,paymentMethod:"Paypal",totalAmount:F+210,user:{email:null==T?void 0:T.email,fullName:null==T?void 0:T.fullName},cartProducts:M,billingAddress:T,shippingAddress:C,paymentData:e},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>{console.log(e),200===e.status?(Y(),(0,m.Ik)(e.data.successMessage),setTimeout(()=>{(0,v.$8)()?t.push("/user/orders"):t.push("/")},2e3)):(0,m.hW)(e.data.errorMessage)}).catch(e=>{j(!1),console.log(e),(0,m.hW)(null==e?void 0:e.message)})};return(0,l.jsxs)("div",{className:n().checkout,children:[(0,l.jsx)("div",{className:"p-[30px]",children:(0,l.jsx)(y.Z,{step:1,loading:a})}),(0,l.jsx)("h1",{className:n().title,children:"Checkout"}),!(0,v.$8)()&&(0,l.jsx)(i.Z,{className:"max-w-[600px] m-[20px] ml-[30px]",type:"warning",message:(0,l.jsxs)("div",{children:["Please ",(0,l.jsx)("button",{onClick:()=>{localStorage.setItem("redirectUrl","/checkout"),t.push("/login")},className:"btn underline",children:"Login"})," before placing order if you want to track your orders"]})}),(0,l.jsxs)(h.Z,{gutter:[23,23],children:[(0,l.jsx)(c.Z,{xs:24,md:17,children:(0,l.jsx)("div",{className:"p-[17px] md:p-[40px]",style:{maxWidth:800},children:A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h2",{className:"text-[28px]",children:["Please pay total amount of ",(0,l.jsxs)("b",{children:["$",F+210]})," to process your order."]}),(0,l.jsx)(k.Vv,{options:{"client-id":"AUpL1Gs0zYxjvK8DPipH21S7JXrf-E7gTDDhMI16RN9iblvonYEXDESBdY8qV6uUGUbtPXK2btQsrWPT",components:"buttons",currency:"USD"},children:(0,l.jsx)(PaypalButtonWrapper,{amount:F+210,placeOrder:transactionSuccess,currency:"USD",showSpinner:!1})})]}):(0,l.jsx)(o.Z,{layout:"vertical",form:s,name:"nest-messages",className:n().form,initialValues:{billingAddress:{fullName:"",address:"",address2:""}},children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"mb-8",children:"Billing Details: "}),(0,l.jsx)(o.Z.Item,{name:["billingAddress","fullName"],label:"Full Name",rules:[{required:!0,message:"Please enter your Full Name!"}],children:(0,l.jsx)(u.default,{placeholder:"Enter Full Name"})}),(0,l.jsx)(h.Z,{gutter:[23,23],children:(0,l.jsxs)(c.Z,{xs:24,children:[(0,l.jsx)(o.Z.Item,{name:["billingAddress","address"],label:"Address",rules:[{required:!0,message:"Please enter your Address!"}],children:(0,l.jsx)(u.default,{placeholder:"Enter Address 2"})}),(0,l.jsx)(o.Z.Item,{name:["billingAddress","address2"],children:(0,l.jsx)(u.default,{placeholder:"Enter Apartment, suit, unit etc(optional)"})})]})})]})})})}),(0,l.jsx)(c.Z,{xs:24,md:7,className:n().right,children:(0,l.jsxs)("div",{className:"p-[17px] md:p-[20px] mb-10 md:mb-0",children:[(0,l.jsx)("h3",{children:"Order Details:"}),null==M?void 0:M.map((e,s)=>(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("h4",{className:"font-bolder text-[16px] max-w-[170px]",children:[null==e?void 0:e.title," x ",null==e?void 0:e.qtyToShop]}),(0,l.jsx)("div",{className:"w-fit",children:(0,l.jsxs)("h4",{className:"font-bold text-[16px]",children:["$",parseInt(null==e?void 0:e.Price)*parseInt(null==e?void 0:e.qtyToShop)]})})]},s)),(0,l.jsx)(d.Z,{}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsx)("h5",{children:"Sub Total"}),(0,l.jsxs)("h5",{children:["$",F]})]}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsx)("h5",{children:"Shipping"}),(0,l.jsxs)("h5",{children:["$",210]})]}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsxs)("h5",{children:["Order Total ",(0,l.jsx)("br",{})]}),(0,l.jsxs)("h5",{children:["$",F+210]})]}),(0,l.jsx)("div",{children:(0,l.jsx)(p.C,{text:"MAKE PAYMENT",loading:a,disabled:a,onClick:()=>{s.submit();let{billingAddress:e}=s.getFieldsValue();(null==e?void 0:e.fullName)&&(null==e?void 0:e.address)&&(w(e),I(!0))}})})]})})]})]})}},10368:function(e){e.exports={checkout:"checkout_checkout__zCm2g",title:"checkout_title__y4HGc",TextArea:"checkout_TextArea__tcVby",auth:"checkout_auth__TEiOH",form:"checkout_form__5zQIa",right:"checkout_right__tm1Gl",promotionCode:"checkout_promotionCode__iRB7C",orderDetailItem:"checkout_orderDetailItem___bhnc"}}},function(e){e.O(0,[4885,8614,9858,1024,4055,7538,2996,4806,881,5066,9774,2888,179],function(){return e(e.s=72590)}),_N_E=e.O()}]);